{{define "domains"}}
<div class="row">
    <div class="panel panel-default panel-pad">
        <div class="panel-body admin-min-height">
        	<div class="row">
        		{{template "sidebar" .}}
		        <div class="col-sm-9 col-sm-offset-3 col-md-10 col-md-offset-0 main">
                    <div class="page-header domain-pg-hdr">
		        	 <h2>Domains
                         <div class="nav-form pull-right" style="margin-top:-5px">
                            <button type="button" class="btn btn-default btn-sm btn-urlite-g" id="addDomain" style="width:65px">Add</button>
                         </div>
                     </h2>                     
                    </div>
		        	<div class="dcontent">
                        <table class="table table-striped table-hover">
                            <thead>
                                <tr>
                                    <th style="width:3%">Scheme</th>
                                    <th style="width:15%">Name</th>
                                    <th style="width:15%">Total Urlite</th>
                                    <th style="width:15%">Urlite</th>
                                    <th style="width:15%">Custom Urlite</th>
                                </tr>
                            </thead>
                            <tbody>
                            {{range .Domains}}
                                <tr>
                                    <td>{{.Scheme}}</td>
                                    <td>{{.Name}}</td>
                                    {{$total := add .LinkCount .CustomLinkCount}}
                                    <td>{{num2str $total ','}}</td>
                                    <td>{{num2str .LinkCount ','}}</td>
                                    <td>{{num2str .CustomLinkCount ','}}</td>
                                </tr>
                            {{end}}
                            </tbody>
                        </table>
		        	</div><!--/.dcontent -->
		        </div> <!--/.main -->
        	</div>
        </div> <!--/.panel-body -->
    </div>
</div>
<div class="modal fade" id="domainAddModal" tabindex="-1" role="dialog" aria-labelledby="domainAddModalLabel">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
        <h4 class="modal-title" id="domainAddModalLabel">Adding a new Domain</h4>
      </div>
      <div class="modal-body">
        <div class="container-fluid">
            <form id="domainForm" class="form-horizontal">
                <div class="form-group has-feedback">
                    <label for="dName" class="col-sm-4 control-label">Domain Name</label>
                    <div class="col-sm-7">
                        <input type="text" data-minlength="4" class="form-control" id="dName" name="dName" placeholder="Domain Name" data-error="Domain Name is required!" required>
                        <div class="help-block with-errors"></div>
                    </div>                    
                </div>
                <div class="form-group">
                    <label for="dName" class="col-sm-4 control-label">Domain Scheme</label>
                    <div class="col-sm-7">
                        <input type="text" class="form-control" id="dScheme" name="dScheme" placeholder="Domain Scheme. for eg. http/https" required>
                    </div>
                </div>
                <div class="form-group">
                    <label for="dName" class="col-sm-4 control-label">Collection Name</label>
                    <div class="col-sm-7">
                        <input type="text" class="form-control" id="dColl" name="dColl" placeholder="Collection Name">
                    </div>
                </div>
                <div class="form-group">
                    <label for="dName" class="col-sm-4 control-label">Stats Collection Name</label>
                    <div class="col-sm-7">
                        <input type="text" class="form-control" id="dStatsColl" name="dStatsColl" placeholder="Stats Collection Name">
                    </div>
                </div>
                <div class="form-group col-sm-6 pull-right" style="margin-right:-25px;margin-top:10px;">
                    <button type="button" class="btn btn-default btn-urlite-r" data-dismiss="modal">Close</button>
                    <button type="submit" class="btn btn-success btn-green">Save changes</button>
                </div>
            </form>
        </div>
      </div>
      <!-- <div class="modal-footer">
        <button type="button" class="btn btn-default btn-urlite-r" data-dismiss="modal">Close</button>
        <button type="button" class="btn btn-success btn-green">Save changes</button>
      </div> -->
    </div><!-- /.modal-content -->
  </div><!-- /.modal-dialog -->
</div><!-- /.modal -->
<script type="text/javascript">
    function wpr() {
        $("#addDomain").click(function(){
            $("#domainAddModal")
            .on('show.bs.modal', function (e) {
                //var button = $(e.relatedTarget)
                //var modal = $(this)
                //$(this).find('.modal-body [name="dName"]').focus();
                //alert(modal.find('.modal-body [name="dName"]'))
                //modal.find('.modal-body [name="dName"]').val('')
                //modal.removeData('show.bs.modal')
            })
            .on('shown.bs.modal', function (e) {
                 $(this).find('.modal-body [name="dName"]').focus();
            })
            .on('hidden.bs.modal', function (e) {            
                $(this).find('.modal-body input').val('');
            })
            .modal('show');
        });

        console.log($('#domainForm'));

        $('#domainForm').validator().on('submit', function (e) {
            if (e.isDefaultPrevented()) {
                // handle the invalid form...
                console.log('having error');
            } else {
                // everything looks good!
                console.log('looks good');
                return false;
            }
        });

        // $('#domainForm').validate({
        //     rules: {
        //         dName: {
        //             required: true
        //         },
        //         dScheme: {
        //             required: true
        //         },
        //         dColl: {
        //             required: true
        //         },
        //         dStatsColl: {
        //             required: true
        //         }
        //     },
        //     highlight: function(element) {
        //         $(element).closest('.form-group').addClass('has-error');
        //     },
        //     unhighlight: function(element) {
        //         $(element).closest('.form-group').removeClass('has-error');
        //     },
        //     errorElement: 'span',
        //     errorClass: 'help-block',
        //     errorPlacement: function(error, element) {
        //         if(element.parent('.input-group').length) {
        //             error.insertAfter(element.parent());
        //         } else {
        //             error.insertAfter(element);
        //         }
        //     },
        //     submitHandler: function(form) {
        //         form.submit();
        //     },
        //     invalidHandler: function(event, validator) {
        //         // // 'this' refers to the form
        //         // var errors = validator.numberOfInvalids();
        //         // if (errors) {
        //         //     var message = errors == 1
        //         //     ? 'You missed 1 field. It has been highlighted'
        //         //     : 'You missed ' + errors + ' fields. They have been highlighted';
        //         //     $("div.error span").html(message);
        //         //     $("div.error").show();
        //         // } else {
        //         //     $("div.error").hide();
        //         // }
        //     }
        // });


        //     framework: 'bootstrap',
        //     excluded: [':disabled'],
        //     icon: {
        //         valid: 'glyphicon glyphicon-ok',
        //         invalid: 'glyphicon glyphicon-remove',
        //         validating: 'glyphicon glyphicon-refresh'
        //     },
        //     fields: {
        //         dName: {
        //             validators: {
        //                 notEmpty: {
        //                     message: 'Domain name is required'
        //                 }
        //             }
        //         },
        //         password: {
        //             validators: {
        //                 notEmpty: {
        //                     message: 'The password is required'
        //                 }
        //             }
        //         }
        //     }
        // });

        // $('#dName').on('blur' , function(e) {
        //     alert('name out');
        // });
        // alert('here');
    }
</script>
{{end}}